@page
@model OpenSaludSecurity.Pages.Requests.DetailsModel

@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>Details</title>
</head>
<body>

    <div>
        <h4>Request</h4>
        <hr />
        <dl class="row">
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Request.Name)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Request.Name)
            </dd>
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Request.Email)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Request.Email)
            </dd>
            <dt class="col-sm-2">
                @Html.DisplayNameFor(model => model.Request.Status)
            </dt>
            <dd class="col-sm-10">
                @Html.DisplayFor(model => model.Request.Status)
            </dd>
        </dl>
    </div>
    @if (Model.Request.Status != RequestStatus.Approved)
    {
        @if ((await AuthorizationService.AuthorizeAsync(
      User, Model.Request, ContactOperations.Approve)).Succeeded)
        {
            <form style="display:inline;" method="post">
                <input type="hidden" name="id" value="@Model.Request.RequestId" />
                <input type="hidden" name="status" value="@RequestStatus.Approved" />
                <button type="submit" class="btn btn-xs btn-success">Approve</button>
            </form>
        }
    }
    @if (Model.Request.Status != RequestStatus.Rejected)
    {
        @if ((await AuthorizationService.AuthorizeAsync(
       User, Model.Request, ContactOperations.Reject)).Succeeded)
        {
            <form style="display:inline;" method="post">
                <input type="hidden" name="id" value="@Model.Request.RequestId" />
                <input type="hidden" name="status" value="@RequestStatus.Rejected" />
                <button type="submit" class="btn btn-xs btn-danger">Reject</button>
            </form>
        }
    }
    <div>
        @if ((await AuthorizationService.AuthorizeAsync(
            User, Model.Request,
            ContactOperations.Update)).Succeeded)
        {
            <a asp-page="./Edit" asp-route-id="@Model.Request.RequestId">Edit</a>
            <text> | </text>
        }
        <a asp-page="./Index">Back to List</a>
    </div>
</body>
</html>
